<UserControl
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:av="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="av"
        x:Class="BOZea.Views.Payment.PaymentView"
    FontFamily="Plus Jakarta Sans"
    Background="#F8F9FA"
        av:DesignHeight="1442.4"
        av:DesignWidth="848">

    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/BOZea;component/Views/Styles/MaterialOverrides.xaml"/>
            </ResourceDictionary.MergedDictionaries>

            <!-- Payment Method Button Style -->
            <Style x:Key="PaymentMethodButton"
                   TargetType="{x:Type RadioButton}">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type RadioButton}">
                            <Border x:Name="border"
                                    Background="White"
                                    BorderBrush="#E0E0E0"
                                    BorderThickness="2"
                                    CornerRadius="12"
                                    Padding="20"
                                    Margin="0,0,0,12"
                                    Cursor="Hand">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <!-- Radio Circle -->
                                    <Ellipse x:Name="radioCircle"
                                             Width="20"
                                             Height="20"
                                             Stroke="#999"
                                             StrokeThickness="2"
                                             Fill="Transparent"
                                             Margin="0,0,15,0"/>
                                    <Ellipse x:Name="radioInner"
                                             Width="10"
                                             Height="10"
                                             Fill="{StaticResource PrimaryBlueBrush}"
                                             Visibility="Collapsed"
                                             Margin="0,0,15,0"/>

                                    <!-- Payment Info -->
                                    <StackPanel Grid.Column="1"
                                                VerticalAlignment="Center">
                                        <TextBlock Text="{TemplateBinding Content}"
                                                   FontSize="16"
                                                   FontWeight="SemiBold"
                                                   Foreground="#333"
                                                   Margin="0,0,0,4"/>
                                        <TextBlock Text="{TemplateBinding Tag}"
                                                   FontSize="13"
                                                   Foreground="#999"/>
                                    </StackPanel>

                                    <!-- Icon -->
                                    <TextBlock Grid.Column="2"
                                               Text="{TemplateBinding ToolTip}"
                                               FontSize="32"
                                               VerticalAlignment="Center"/>
                                </Grid>
                            </Border>

                            <ControlTemplate.Triggers>
                                <Trigger Property="IsChecked"
                                         Value="True">
                                    <Setter TargetName="border"
                                            Property="BorderBrush"
                                            Value="{StaticResource PrimaryBlueBrush}"/>
                                    <Setter TargetName="border"
                                            Property="Background"
                                            Value="#F0F7FF"/>
                                    <Setter TargetName="radioCircle"
                                            Property="Stroke"
                                            Value="{StaticResource PrimaryBlueBrush}"/>
                                    <Setter TargetName="radioInner"
                                            Property="Visibility"
                                            Value="Visible"/>
                                </Trigger>
                                <Trigger Property="IsMouseOver"
                                         Value="True">
                                    <Setter TargetName="border"
                                            Property="BorderBrush"
                                            Value="{StaticResource PrimaryBlueBrush}"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <!-- Quantity Button Style -->
            <Style x:Key="QuantityButton"
                   TargetType="{x:Type Button}">
                <Setter Property="Width"
                        Value="40"/>
                <Setter Property="Height"
                        Value="40"/>
                <Setter Property="Background"
                        Value="White"/>
                <Setter Property="BorderBrush"
                        Value="#E0E0E0"/>
                <Setter Property="BorderThickness"
                        Value="1"/>
                <Setter Property="Cursor"
                        Value="Hand"/>
                <Setter Property="FontSize"
                        Value="18"/>
                <Setter Property="FontWeight"
                        Value="Bold"/>
                <Setter Property="Foreground"
                        Value="#333"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type Button}">
                            <Border Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    CornerRadius="8">
                                <ContentPresenter HorizontalAlignment="Center"
                                                  VerticalAlignment="Center"/>
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
                <Style.Triggers>
                    <Trigger Property="IsMouseOver"
                             Value="True">
                        <Setter Property="Background"
                                Value="{StaticResource PrimaryBlueBrush}"/>
                        <Setter Property="Foreground"
                                Value="White"/>
                        <Setter Property="BorderBrush"
                                Value="{StaticResource PrimaryBlueBrush}"/>
                    </Trigger>
                </Style.Triggers>
            </Style>
        </ResourceDictionary>
    </UserControl.Resources>

    <Grid>
        <!-- Main Content -->
        <ScrollViewer VerticalScrollBarVisibility="Auto">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="500"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Main Content -->
                <StackPanel Grid.Column="1"
                            Margin="0,60,0,60">

                    <!-- Header -->
                    <StackPanel Margin="0,0,0,40">
                        <!-- Back Button -->
                        <Button Command="{Binding BackCommand}"
                                Background="Transparent"
                                BorderThickness="0"
                                Cursor="Hand"
                                HorizontalAlignment="Left"
                                Margin="0,0,0,30"
                                Padding="0,0">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="â†"
                                           FontSize="20"
                                           FontWeight="Bold"
                                           Foreground="#333"
                                           Margin="0,0,10,0"
                                           VerticalAlignment="Center"/>
                                <TextBlock Text="Back"
                                           FontSize="16"
                                           FontWeight="Medium"
                                           Foreground="#333"
                                           VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>

                        <TextBlock Text="Payment Detail"
                                   FontSize="36"
                                   FontWeight="Bold"
                                   Foreground="#1A1A1A"
                                   HorizontalAlignment="Center"/>
                    </StackPanel>

                    <!-- Product Card -->
                    <Border Background="White"
                            CornerRadius="16"
                            Padding="30"
                            Margin="0,0,0,30">
                        <Border.Effect>
                            <DropShadowEffect Color="#000000"
                                              Direction="270"
                                              ShadowDepth="2"
                                              BlurRadius="20"
                                              Opacity="0.08"/>
                        </Border.Effect>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Product Image -->
                            <Border Width="150"
                                    Height="150"
                                    Background="#F5F5F5"
                                    CornerRadius="12"
                                    Margin="0,0,20,0">
                                <Image Source="{Binding ProductImage}"
                                       Stretch="UniformToFill"/>
                            </Border>

                            <!-- Product Info -->
                            <StackPanel Grid.Column="1"
                                        VerticalAlignment="Center">
                                <TextBlock Text="{Binding ProductName}"
                                           FontSize="20"
                                           FontWeight="SemiBold"
                                           Foreground="#1A1A1A"
                                           TextWrapping="Wrap"
                                           Margin="0,0,0,8"/>
                                <TextBlock Text="{Binding ProductCategory}"
                                           FontSize="14"
                                           Foreground="#999"
                                           Margin="0,0,0,12"/>
                                <TextBlock Text="{Binding ProductPrice}"
                                           FontSize="24"
                                           FontWeight="Bold"
                                           Foreground="{StaticResource PrimaryBlueBrush}"/>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Quantity Section -->
                    <Border Background="White"
                            CornerRadius="16"
                            Padding="30"
                            Margin="0,0,0,30">
                        <Border.Effect>
                            <DropShadowEffect Color="#000000"
                                              Direction="270"
                                              ShadowDepth="2"
                                              BlurRadius="20"
                                              Opacity="0.08"/>
                        </Border.Effect>

                        <Grid>
                            <TextBlock Text="Quantity"
                                       FontSize="16"
                                       FontWeight="SemiBold"
                                       Foreground="#333"
                                       VerticalAlignment="Center"/>

                            <StackPanel Orientation="Horizontal"
                                        HorizontalAlignment="Right">
                                <Button Content="âˆ’"
                                        Style="{StaticResource QuantityButton}"
                                        Command="{Binding DecreaseQuantityCommand}"/>
                                <Border Background="#F8F9FA"
                                        BorderBrush="#E0E0E0"
                                        BorderThickness="1"
                                        CornerRadius="8"
                                        Width="60"
                                        Height="40"
                                        Margin="12,0">
                                    <TextBlock Text="{Binding Quantity}"
                                               FontSize="18"
                                               FontWeight="SemiBold"
                                               Foreground="#333"
                                               HorizontalAlignment="Center"
                                               VerticalAlignment="Center"/>
                                </Border>
                                <Button Content="+"
                                        Style="{StaticResource QuantityButton}"
                                        Command="{Binding IncreaseQuantityCommand}"/>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Payment Method Section -->
                    <Border Background="White"
                            CornerRadius="16"
                            Padding="30"
                            Margin="0,0,0,30">
                        <Border.Effect>
                            <DropShadowEffect Color="#000000"
                                              Direction="270"
                                              ShadowDepth="2"
                                              BlurRadius="20"
                                              Opacity="0.08"/>
                        </Border.Effect>

                        <StackPanel>
                            <TextBlock Text="Payment Method"
                                       FontSize="18"
                                       FontWeight="SemiBold"
                                       Foreground="#1A1A1A"
                                       Margin="0,0,0,20"/>

                            <!-- Payment Options -->
                            <RadioButton Content="Credit Card"
                                         Tag="Visa, Mastercard, Amex"
                                         ToolTip="ðŸ’³"
                                         Style="{StaticResource PaymentMethodButton}"
                                         GroupName="PaymentMethod"
                                         IsChecked="{Binding IsCreditCardSelected}"/>

                            <RadioButton Content="Bank Transfer"
                                         Tag="BCA, Mandiri, BNI"
                                         ToolTip="ðŸ¦"
                                         Style="{StaticResource PaymentMethodButton}"
                                         GroupName="PaymentMethod"
                                         IsChecked="{Binding IsBankTransferSelected}"/>

                            <RadioButton Content="E-Wallet"
                                         Tag="GoPay, OVO, Dana"
                                         ToolTip="ðŸ“±"
                                         Style="{StaticResource PaymentMethodButton}"
                                         GroupName="PaymentMethod"
                                         IsChecked="{Binding IsEWalletSelected}"/>

                            <RadioButton Content="Cash on Delivery"
                                         Tag="Pay when you receive"
                                         ToolTip="ðŸ’µ"
                                         Style="{StaticResource PaymentMethodButton}"
                                         GroupName="PaymentMethod"
                                         IsChecked="{Binding IsCODSelected}"/>
                        </StackPanel>
                    </Border>

                    <!-- Total Section -->
                    <Border Background="White"
                            CornerRadius="16"
                            Padding="30"
                            Margin="0,0,0,30">
                        <Border.Effect>
                            <DropShadowEffect Color="#000000"
                                              Direction="270"
                                              ShadowDepth="2"
                                              BlurRadius="20"
                                              Opacity="0.08"/>
                        </Border.Effect>

                        <Grid>
                            <TextBlock Text="Total Amount"
                                       FontSize="18"
                                       FontWeight="SemiBold"
                                       Foreground="#333"
                                       VerticalAlignment="Center"/>
                            <TextBlock Text="{Binding TotalPrice}"
                                       FontSize="20"
                                       FontWeight="SemiBold"
                                       HorizontalAlignment="Right"
                                       VerticalAlignment="Center"/>
                        </Grid>
                    </Border>

                    <!-- Pay Button -->
                    <Button Command="{Binding PayCommand}"
                            Background="{StaticResource PrimaryBlueBrush}"
                            Foreground="White"
                            BorderThickness="0"
                            Height="60"
                            Cursor="Hand"
                            FontSize="18"
                            FontWeight="SemiBold"
                            Content="{Binding PayButtonText}">
                        <Button.Style>
                            <Style TargetType="{x:Type Button}">
                                <Setter Property="Background"
                                        Value="{StaticResource PrimaryBlueBrush}"/>
                                <Setter Property="Foreground"
                                        Value="White"/>
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="{x:Type Button}">
                                            <Border Background="{TemplateBinding Background}"
                                                    CornerRadius="12"
                                                    Padding="0,0">
                                                <Border.Effect>
                                                    <DropShadowEffect Color="#0066FF"
                                                                      Direction="270"
                                                                      ShadowDepth="4"
                                                                      BlurRadius="20"
                                                                      Opacity="0.4"/>
                                                </Border.Effect>
                                                <TextBlock Text="{TemplateBinding Content}"
                                                           Foreground="White"
                                                           FontWeight="SemiBold"
                                                           FontSize="18"
                                                           HorizontalAlignment="Center"
                                                           VerticalAlignment="Center"/>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>

                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver"
                                             Value="True">
                                        <Setter Property="Background"
                                                Value="#0056D2"/>
                                    </Trigger>
                                    <Trigger Property="IsPressed"
                                             Value="True">
                                        <Setter Property="Background"
                                                Value="#004AB8"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>

                </StackPanel>
            </Grid>
        </ScrollViewer>

        <!-- Payment Confirmation Overlay -->
        <Grid x:Name="OverlayGrid"
              Background="#00000000"
              Visibility="Collapsed">

            <!-- Backdrop -->
            <Rectangle Fill="#000000"
                       Opacity="0.5"
                       MouseDown="Backdrop_MouseDown"/>

            <!-- Dialog Content -->
            <Border Background="White"
                    CornerRadius="20"
                    Padding="40"
                    VerticalAlignment="Center"
                    HorizontalAlignment="Center"
                    MaxWidth="500"
                    MinWidth="450">
                <Border.Effect>
                    <DropShadowEffect Color="#000000"
                                      Direction="270"
                                      ShadowDepth="8"
                                      BlurRadius="30"
                                      Opacity="0.25"/>
                </Border.Effect>

                <StackPanel>
                    <!-- Success Icon -->
                    <TextBlock Text="âœ“"
                               FontSize="64"
                               Foreground="{StaticResource PrimaryBlueBrush}"
                               HorizontalAlignment="Center"
                               Margin="0,0,0,20"/>

                    <!-- Title -->
                    <TextBlock Text="Confirm Payment"
                               FontSize="28"
                               FontWeight="Bold"
                               Foreground="#1A1A1A"
                               HorizontalAlignment="Center"
                               Margin="0,0,0,12"/>

                    <!-- Divider -->
                    <Rectangle Height="2"
                               Fill="#F0F0F0"
                               Margin="0,0,0,24"/>

                    <!-- Product Info -->
                    <StackPanel Margin="0,0,0,24"
                                x:Name="DialogContent">
                        <Grid Margin="0,0,0,12">
                            <TextBlock Text="Product"
                                       Foreground="#666"
                                       FontSize="14"/>
                            <TextBlock Text="{Binding DialogViewModel.ProductName}"
                                       HorizontalAlignment="Right"
                                       FontSize="14"
                                       FontWeight="SemiBold"
                                       Foreground="#333"
                                       TextTrimming="CharacterEllipsis"
                                       MaxWidth="250"
                                       TextWrapping="NoWrap"
                                       ToolTip="{Binding DialogViewModel.ProductName}"/>
                        </Grid>

                        <Grid Margin="0,0,0,12">
                            <TextBlock Text="Quantity"
                                       Foreground="#666"
                                       FontSize="14"/>
                            <TextBlock Text="{Binding DialogViewModel.Quantity}"
                                       HorizontalAlignment="Right"
                                       FontSize="14"
                                       FontWeight="SemiBold"
                                       Foreground="#333"/>
                        </Grid>

                        <Grid Margin="0,0,0,12">
                            <TextBlock Text="Payment Method"
                                       Foreground="#666"
                                       FontSize="14"/>
                            <TextBlock Text="{Binding DialogViewModel.PaymentMethod}"
                                       HorizontalAlignment="Right"
                                       FontSize="14"
                                       FontWeight="SemiBold"
                                       Foreground="#333"/>
                        </Grid>

                        <!-- Divider -->
                        <Rectangle Height="1"
                                   Fill="#E0E0E0"
                                   Margin="0,12"/>

                        <!-- Total -->
                        <Grid>
                            <TextBlock Text="Total Amount"
                                       Foreground="#333"
                                       FontSize="16"
                                       FontWeight="SemiBold"/>
                            <TextBlock Text="{Binding DialogViewModel.TotalPrice}"
                                       HorizontalAlignment="Right"
                                       FontSize="20"
                                       FontWeight="Bold"
                                       Foreground="{StaticResource PrimaryBlueBrush}"/>
                        </Grid>
                    </StackPanel>

                    <!-- Buttons -->
                    <StackPanel Orientation="Horizontal"
                                Margin="0,24,0,0">
                        <!-- Cancel Button -->
                        <Button Content="Cancel"
                                Background="#F5F5F5"
                                Foreground="#333"
                                BorderThickness="0"
                                Height="48"
                                Cursor="Hand"
                                FontSize="16"
                                FontWeight="SemiBold"
                                Click="CancelButton_Click"
                                Padding="20,0"
                                Margin="0,0,12,0">
                            <Button.Style>
                                <Style TargetType="{x:Type Button}">
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="{x:Type Button}">
                                                <Border Background="{TemplateBinding Background}"
                                                        CornerRadius="12"
                                                        Padding="{TemplateBinding Padding}">
                                                    <ContentPresenter HorizontalAlignment="Center"
                                                                      VerticalAlignment="Center"/>
                                                </Border>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver"
                                                 Value="True">
                                            <Setter Property="Background"
                                                    Value="#E8E8E8"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </Button.Style>
                        </Button>

                        <!-- Confirm Button -->
                        <Button Content="âœ“ Confirm"
                                Background="{StaticResource PrimaryBlueBrush}"
                                Foreground="White"
                                BorderThickness="0"
                                Height="48"
                                Cursor="Hand"
                                FontSize="16"
                                FontWeight="SemiBold"
                                Click="ConfirmButton_Click"
                                Padding="20,0">
                            <Button.Style>
                                <Style TargetType="{x:Type Button}">
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="{x:Type Button}">
                                                <Border Background="{TemplateBinding Background}"
                                                        CornerRadius="12"
                                                        Padding="{TemplateBinding Padding}">
                                                    <Border.Effect>
                                                        <DropShadowEffect Color="#0066FF"
                                                                          Direction="270"
                                                                          ShadowDepth="3"
                                                                          BlurRadius="15"
                                                                          Opacity="0.3"/>
                                                    </Border.Effect>
                                                    <ContentPresenter HorizontalAlignment="Center"
                                                                      VerticalAlignment="Center"/>
                                                </Border>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver"
                                                 Value="True">
                                            <Setter Property="Background"
                                                    Value="#0056D2"/>
                                        </Trigger>
                                        <Trigger Property="IsPressed"
                                                 Value="True">
                                            <Setter Property="Background"
                                                    Value="#004AB8"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </Button.Style>
                        </Button>
                    </StackPanel>
                </StackPanel>
            </Border>
        </Grid>

        <!-- Success Dialog Overlay -->
        <Grid x:Name="SuccessOverlayGrid"
              Background="#00000000"
              Visibility="Collapsed">

            <!-- Backdrop -->
            <Rectangle Fill="#000000"
                       Opacity="0.5"/>

            <!-- Success Dialog -->
            <Border Background="White"
                    CornerRadius="20"
                    Padding="40"
                    VerticalAlignment="Center"
                    HorizontalAlignment="Center"
                    MaxWidth="450"
                    MinWidth="400">
                <Border.Effect>
                    <DropShadowEffect Color="#000000"
                                      Direction="270"
                                      ShadowDepth="8"
                                      BlurRadius="30"
                                      Opacity="0.25"/>
                </Border.Effect>

                <StackPanel>
                    <!-- Success Icon - Grid dengan centered content -->
                    <Grid Width="80"
                          Height="80"
                          HorizontalAlignment="Center"
                          Margin="0,0,0,20">
                        <!-- Green Circle Background -->
                        <Ellipse Fill="#22C55E"
                                 Width="80"
                                 Height="80"/>

                        <!-- Checkmark centered -->
                        <TextBlock Text="âœ“"
                                   FontSize="48"
                                   Foreground="White"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"
                                   TextAlignment="Center"/>
                    </Grid>

                    <!-- Title -->
                    <TextBlock Text="Payment Successful!"
                               FontSize="28"
                               FontWeight="Bold"
                               Foreground="#1A1A1A"
                               HorizontalAlignment="Center"
                               Margin="0,0,0,12"/>

                    <!-- Message -->
                    <TextBlock Text="Thank you for your payment. Redirecting to dashboard..."
                               FontSize="16"
                               Foreground="#666"
                               TextAlignment="Center"
                               TextWrapping="Wrap"
                               Margin="0,0,0,24"/>

                    <!-- Order ID -->
                    <Border Background="#F5F5F5"
                            CornerRadius="12"
                            Padding="16"
                            Margin="0,0,0,0">
                        <Grid>
                            <TextBlock Text="Order ID"
                                       Foreground="#666"
                                       FontSize="13"/>
                            <TextBlock Text="{Binding OrderId}"
                                       HorizontalAlignment="Right"
                                       FontSize="13"
                                       FontWeight="SemiBold"
                                       Foreground="{StaticResource PrimaryBlueBrush}"/>
                        </Grid>
                    </Border>
                </StackPanel>
            </Border>
        </Grid>
    </Grid>
</UserControl>